<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PREDICT — Avan data portal</title>
  <style>
    :root {
      --brand-primary: #002F6C;
      --brand-secondary: #7A9AAE;
      --brand-accent: #E6B800;
      --text: #222;
      --muted: #666;
      --bg: #fff;
      --soft: #f6f8fa;
      --border: #e1e4e8;
    }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; color:var(--text); background:var(--bg); }
    header { background: var(--brand-primary); color: white; padding: 1.5rem 1rem; }
    header .container { max-width: 1100px; margin: 0 auto; }
    h1 { margin: 0; font-weight: 700; letter-spacing: 0.3px; }
    .subtitle { margin-top: 0.25rem; color: #dfe7f2; }
    main { max-width: 1100px; margin: 1.25rem auto; padding: 0 1rem 3rem; }
    .dataset-card { border: 1px solid var(--border); border-radius: 8px; background: var(--soft); margin-bottom: 1.25rem; }
    .dataset-header { padding: 1rem 1rem 0.75rem; border-bottom: 1px solid var(--border); background: #fff; border-radius: 8px 8px 0 0; }
    .dataset-title { margin: 0; color: var(--brand-primary); }
    .dataset-subtitle { margin: 0.2rem 0 0.4rem; color: var(--muted); font-size: 0.95rem; }
    .dataset-info { font-size: 0.95rem; color: #333; }

    .controls { display: flex; gap: 0.75rem; align-items: center; padding: 0.8rem 1rem; background: var(--soft); border-bottom: 1px solid var(--border); }
    .controls input[type="search"] { flex: 1; padding: 0.55rem 0.7rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.95rem; }
    .controls .info { color: var(--muted); font-size: 0.9rem; }

    table { width: 100%; border-collapse: collapse; background: #fff; }
    thead th { text-align: left; font-weight: 600; font-size: 0.9rem; color: var(--muted); padding: 0.6rem 0.7rem; border-bottom: 1px solid var(--border); background: #fafbfc; }
    tbody td { padding: 0.6rem 0.7rem; border-bottom: 1px solid var(--border); vertical-align: top; }
    tbody tr:hover { background: #fcfcfd; }
    .var-label { font-weight: 600; }
    .var-notes { color: var(--muted); font-size: 0.9rem; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 0.9rem; }

    .cart { position: sticky; top: 0; z-index: 2; background: #fff; border-bottom: 1px solid var(--border); }
    .cart .container { max-width: 1100px; margin: 0 auto; padding: 0.5rem 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem 1rem; align-items: center; }
    .tag { background: var(--soft); border: 1px solid var(--border); border-radius: 999px; padding: 0.25rem 0.6rem; font-size: 0.85rem; }
    .btn { appearance: none; background: var(--brand-primary); color:#fff; border: none; border-radius: 6px; padding: 0.5rem 0.8rem; cursor: pointer; }
    .btn.secondary { background: var(--brand-secondary); }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }

    footer { max-width: 1100px; margin: 2rem auto; padding: 0 1rem 3rem; color: var(--muted); font-size: 0.9rem; }
    details { margin-top: 0.35rem; }

    @media (max-width: 720px) {
      .hide-sm { display: none; }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>PREDICT</h1>
      <div class="subtitle">Avan data portal</div>
    </div>
  </header>

  <div class="cart">
    <div class="container">
      <strong>Selected variables:</strong>
      <span id="cart-count" class="tag">0</span>
      <button id="download-csv" class="btn" disabled>Download CSV</button>
      <button id="clear-selection" class="btn secondary" disabled>Clear</button>
      <span class="hide-sm" style="color:var(--muted)">Selections persist during this session only.</span>
    </div>
  </div>

  <main id="app">
    <!-- Datasets will be rendered here -->
  </main>

  <!-- Inlined normalized data from build.py -->
  <script id="dataset-json" type="application/json">[{"id":"ps_cancer","info":["This dataset is an extract from the National Cancer Register, covering the period from 1958-01-01 to 2022-03-31. It includes all individuals in the Predict cohort who included in the National Cancer Register.","Date of extraction: 2025-02-25","Official site: https://www.socialstyrelsen.se/statistik-och-data/register/cancerregistret/","The National Board of Health and Welfare (Socialstyrelsen) provides a variable list online. Variable names correspond to the `colname_silver` value in Avan's internal codebook: https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/dokument-webb/statistik/register-variabelforteckning-cancerregistret.xlsx"],"subtitle":"Data extract from the National Board of Health and Welfare (Socialstyrelsen)","title":"National Cancer Register","variables":[{"category":"demography","label":"Age at diagnosis","name":"age_diagnosis","notes":"Derived from `diagnosis_date` and `birthdate`.","source":"age_diagnosis","type":"double"},{"category":"demography","label":"Date of birth","name":"birthdate","notes":"Extracted from pin","source":"birthdate","type":"date"},{"category":["diagnosis","cancer_diagnosis"],"label":"Date of diagnosis","name":"diagnosis_date","notes":"Where the complete date is unavailable (`diagnosis_date_original`), it has been extrapolated by letting it default to the 1st of the month. This extrapolation affects records prior to 1977; approximately 10% of records from 1974-1976 and around 80-100% of records from 1973 and earlier.","source":"DIADAT_complete","type":"date"},{"category":["diagnosis","cancer_diagnosis"],"label":"Date of diagnosis (dates prior to 1976 may be incomplete)","name":"diagnosis_date_original","notes":"From 1977 onwards, all dates are complete (8 digits). From 1976 and backwards, a large portion of the dates are incomplete (6 digits).","source":"DIADAT","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Malignant or benign tumour","name":"malignancy_status","notes":"Indicates if a tumor is malignant or benign. Further documentation is provided by the National Board of Health and Welfare, in the asset 'Kodning i cancerregistret' (appendix 1)","source":"BEN","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Morphological diagnosis according to C24_1","name":"c24_code","notes":"Tumor morphological diagnosis according to C24.1","source":"PAD","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Morphological diagnosis according to ICD-O-2","name":"snomed2_code","notes":"Tumor morphological diagnosis according to ICD-O-2","source":"SNOMEDO10","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Morphological diagnosis according to ICD-O-3","name":"snomed3_code","notes":"Tumor morphological diagnosis according to ICD-O-3","source":"SNOMED3","type":"character"},{"category":"demography","label":"Sex","name":"sex","notes":"Derived from pin","source":"sex","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-7","name":"icd7_code","notes":"Tumor location according to ICD-7","source":"ICD7","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-9","name":"icd9_code","notes":"Tumor location according to ICD-9-CM","source":"ICD9","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-9 (3-chr)","name":"icd9_3chr_code","notes":"Tumor location according to ICD-9-CM, at three-character level. Derived from `icd9_code` through truncation.","source":"ICD9_3chr_code","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-9 (3-chr)","name":"icd9_3chr_text","notes":"Tumor location according to ICD-9-CM, at three-character level. Derived from `icd9_3chr_code` through in-house translation, based on CDC Archive resources.","source":"ICD9_3chr_text","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-O-2","name":"icdo2_code","notes":"Tumor location according to ICD-O-2. This is a four-character topographical code (except for the three-character code 'D45'), ranging from C00.0 to D47.3. First two digits denote primary location, the last digit denote the sublocation within the primary.","source":"ICDO10","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Tumour location according to ICD-O-3","name":"icdo3_code","notes":"Tumor location according to ICD-O-3. This is a four-character topographical code (except for the three-character code 'D45'), ranging from C00.0 to C80.9. First two digits denote primary location, the last digit denote the sublocation within the primary.","source":"ICDO3","type":"character"},{"category":["diagnosis","cancer_diagnosis"],"label":"Year of diagnosis","name":"diagnosis_year","notes":"Calendar year of diagnosis","source":"AR","type":"integer"}]},{"id":"ps_cause-of-death","info":["This dataset is an extract from the National Cause of Death Register, covering the period from 1958-01-01 to 2022-03-31. It includes all individuals in the Predict cohort with a record in the register within this time span.","Date of extraction: 2025-02-24","Official site: https://www.socialstyrelsen.se/statistik-och-data/register/dodsorsaksregistret/","The National Board of Health and Welfare (Socialstyrelsen) provides a variable list online. Variable names correspond to the `colname_silver` value in Avan's internal codebook: https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/dokument-webb/statistik/register-dodsorsaksregistret-variabelforteckning.xls","ICD code descriptions and hierarchical groupings included in this dataset are based on in-house translations and mappings. While we rely on official sources — including the National Board of Health and Welfare (ICD-10-SE, downloaded 2025-03-20) and the CDC ICD-9-CM archive (downloaded 2025-04-01) — users are encouraged to verify all annotations independently. In particular, the CDC ICD-9-CM data was provided in RTF format and parsed using custom code, which may introduce errors despite our best efforts. Responsibility for analytical decisions based on these annotations ultimately rests with the user. For reference: - ICD-10-SE: https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/dokument-webb/klassifikationer-och-koder/icd-10-se.tsv - CDC archive: https://archive.cdc.gov/www_cdc_gov/nchs/icd/icd9cm.htm - CDC archive resouce: https://ftp.cdc.gov/pub/Health_Statistics/NCHS/Publications/ICD9-CM/2011/Appndx12.zip, ('DC_3D12.RTF' in zip-archive)","The dataset contains up to 17 contributing causes of death in the variables `cod_contributing_01` – `cod_contributing_17` (renamed from `MORSAK1` – `MORSAK17`). These hold all diagnoses listed on the death-certificate in addition to the underlying cause. Precise *priority* or *placement* on the certificate cannot be reconstructed from the current extract, because the RO-variables (`RO1` – `RO48`) — which encode the certificate row and ordinal position (e.g., `RO1 = 101` --> terminal cause in `cod_contributing_01`; `RO2 = 602` --> second listed contributing cause in `cod_contributing_02`) — were not part of our order. According to guidance from the National Board of Health and Welfare, the first digit of an RO code indicates the line on the certificate (rows 1–4 form the causal chain, row 6 lists other contributing causes). A sample certificate illustrating this layout is available at: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/artikelkatalog/foreskrifter-och-allmanna-rad/bilaga6-dodsorsaksintyg.pdf>. The Predict project is currently submitting an additional application to obtain the RO-variables; future releases will therefore allow full reconstruction of the certificate´s ordering of contributing causes."],"subtitle":"Data extract from the National Board of Health and Welfare (Socialstyrelsen)","title":"National Cause of Death Register","variables":[{"category":"death","label":"Age at death","name":"age_death","notes":"Derived from `death_date` and `birthdate`.","source":"age_death","type":"double"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_01","notes":"ICD-code","source":"MORSAK1","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_02","notes":"ICD-code","source":"MORSAK2","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_03","notes":"ICD-code","source":"MORSAK3","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_04","notes":"ICD-code","source":"MORSAK4","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_05","notes":"ICD-code","source":"MORSAK5","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_06","notes":"ICD-code","source":"MORSAK6","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_07","notes":"ICD-code","source":"MORSAK7","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_08","notes":"ICD-code","source":"MORSAK8","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_09","notes":"ICD-code","source":"MORSAK9","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_10","notes":"ICD-code","source":"MORSAK10","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_11","notes":"ICD-code","source":"MORSAK11","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_12","notes":"ICD-code","source":"MORSAK12","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_13","notes":"ICD-code","source":"MORSAK13","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_14","notes":"ICD-code","source":"MORSAK14","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_15","notes":"ICD-code","source":"MORSAK15","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_16","notes":"ICD-code","source":"MORSAK16","type":"character"},{"category":["death","medical_code"],"label":"Contributing cause of death","name":"cod_contributing_17","notes":"ICD-code","source":"MORSAK17","type":"character"},{"category":"demography","label":"Date of birth","name":"birthdate","notes":"Extracted from pin","source":"birthdate","type":"date"},{"category":["death","demography"],"label":"Date of death","name":"death_date","notes":"Where an exact date is unavailable (`death_date_original`), it has been extrapolated by letting missing months default to January and missing days to the 1st of the month.","source":"DODSDAT_valid","type":"date"},{"category":"death","label":"Date of death (00 represents missing month and/or day)","name":"death_date_original","notes":"'00' presumably represents missing month/and or day. Consequently, this column can not be managed as date type.","source":"DODSDAT","type":"character"},{"category":"medical_code","label":"ICD-code version","name":"icd_version","notes":"ICD version used for coding causes of death in each record (e.g., ICD-9 or ICD-10)","source":"ICD","type":"character"},{"category":"demography","label":"Sex","name":"sex","notes":"Derived from pin","source":"sex","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_3chr_code","notes":"Three-character ICD code, derived by truncating `cod_underlying_code`.","source":"ULORSAK_3chr_code","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_3chr_text","notes":"Text description of `cod_underlying_3chr_code`, based on in-house translation using resources from the National Board of Health and Welfare (ICD-10) and the CDC Archive (ICD-9). Texts are in Swedish (ICD-10) and English (ICD-9).","source":"ULORSAK_3chr_text","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_code","notes":"ICD-code","source":"ULORSAK","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_int_code","notes":"Top-level ICD interval code, derived from `cod_underlying_3chr_code` using in-house mapping, based on resources from the National Board of Health and Welfare (ICD-10) and the CDC Archive (ICD-9).","source":"ULORSAK_int_code","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_int_text","notes":"Text description of `cod_underlying_int_code`, based on in-house translation using resources from the National Board of Health and Welfare (ICD-10) and the CDC Archive (ICD-9). Texts are in Swedish (ICD-10) and English (ICD-9).","source":"ULORSAK_int_text","type":"character"},{"category":["death","medical_code"],"label":"Underlying cause of death","name":"cod_underlying_text","notes":"Text description of `cod_underlying_code`, based on in-house translation using resources from the National Board of Health and Welfare (ICD-10) and the CDC Archive (ICD-9). Texts are in Swedish (ICD-10) and English (ICD-9).","source":"ULORSAK_text","type":"character"},{"category":"death","label":"Year of death","name":"death_year","notes":"Calendar year of death","source":"AR","type":"double"}]},{"id":"ps_patient-in","info":["This dataset is an extract from the National In Patient Register (Patientregistret Slutenvård), covering the period from 1987-01-01 to 2022-03-31. It includes all individuals in the Predict cohort with a record in the register related to the requested diagnoses within this time span.","The National Board of Health and Welfare (Socialstyrelsen) provides a variable list online. Variable names correspond to the `colname_silver` value in Avan's internal codebook: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/ovrigt/register-variabelforteckning-patientregistret.xlsx>","Many records contain `BLANKED` code values. This represents code values actively reducted by the National Board of Health and Welfare, because they are not included in the data application.","ICD code descriptions and hierarchical groupings included in this dataset are based on in-house translations and mappings. While we rely on official sources — from the National Board of Health and Welfare — users are encouraged to verify all annotations independently. In particular, the ICD-9-SE data was provided in PDF and XLS format and parsed using custom code, which may introduce errors despite our best efforts. Responsibility for analytical decisions based on these annotations ultimately rests with the user. For reference: - ICD-10-SE: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/klassifikationer-och-koder/icd-10-se.tsv> - ICD-9-SE: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/klassifikationer-och-koder/icd9-klassifikation-av-sjukdomar-1987.pdf> <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/klassifikationer-och-koder/icd-9-klassifikation-av-sjukdomar-1987-ks87.xls>"],"subtitle":"Data extract from the National Board of Health and Welfare (Socialstyrelsen)","title":"National In Patient Register","variables":[{"category":"demography","label":"Age at admission","name":"admission_age","notes":"Derived from `admission_date` and `birthdate`.","source":"age_admission","type":"double"},{"category":"demography","label":"Age at discharge","name":"discharge_age","notes":"Derived from `discharge_date` and `birthdate`.","source":"age_discharge","type":"double"},{"category":"care_episode","label":"Date of admission","name":"admission_date","notes":"Year of introduction: 1964","source":"INDATUM","type":"date"},{"category":"demography","label":"Date of birth","name":"birthdate","notes":"Extracted from pin","source":"birthdate","type":"date"},{"category":"care_episode","label":"Date of discharge","name":"discharge_date","notes":"Year of introduction: 1964","source":"UTDATUM","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 1","name":"procedure_date_01","notes":"Date of procedure 1. Year of introduction: 1997.","source":"OPD1","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 10","name":"procedure_date_10","notes":"Date of procedure 10. Year of introduction: 1997.","source":"OPD10","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 11","name":"procedure_date_11","notes":"Date of procedure 11. Year of introduction: 1997.","source":"OPD11","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 12","name":"procedure_date_12","notes":"Date of procedure 12. Year of introduction: 1997.","source":"OPD12","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 13","name":"procedure_date_13","notes":"Date of procedure 13. Year of introduction: 2009","source":"OPD13","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 14","name":"procedure_date_14","notes":"Date of procedure 14. Year of introduction: 2009","source":"OPD14","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 15","name":"procedure_date_15","notes":"Date of procedure 15. Year of introduction: 2009","source":"OPD15","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 16","name":"procedure_date_16","notes":"Date of procedure 16. Year of introduction: 2009","source":"OPD16","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 17","name":"procedure_date_17","notes":"Date of procedure 17. Year of introduction: 2009","source":"OPD17","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 18","name":"procedure_date_18","notes":"Date of procedure 18. Year of introduction: 2009","source":"OPD18","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 19","name":"procedure_date_19","notes":"Date of procedure 19. Year of introduction: 2009","source":"OPD19","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 2","name":"procedure_date_02","notes":"Date of procedure 2. Year of introduction: 1997.","source":"OPD2","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 20","name":"procedure_date_20","notes":"Date of procedure 20. Year of introduction: 2009","source":"OPD20","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 21","name":"procedure_date_21","notes":"Date of procedure 21. Year of introduction: 2009","source":"OPD21","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 22","name":"procedure_date_22","notes":"Date of procedure 22. Year of introduction: 2009","source":"OPD22","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 23","name":"procedure_date_23","notes":"Date of procedure 23. Year of introduction: 2009","source":"OPD23","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 24","name":"procedure_date_24","notes":"Date of procedure 24. Year of introduction: 2009","source":"OPD24","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 25","name":"procedure_date_25","notes":"Date of procedure 25. Year of introduction: 2009","source":"OPD25","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 26","name":"procedure_date_26","notes":"Date of procedure 26. Year of introduction: 2009","source":"OPD26","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 27","name":"procedure_date_27","notes":"Date of procedure 27. Year of introduction: 2009","source":"OPD27","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 28","name":"procedure_date_28","notes":"Date of procedure 28. Year of introduction: 2009","source":"OPD28","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 29","name":"procedure_date_29","notes":"Date of procedure 29. Year of introduction: 2009","source":"OPD29","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 3","name":"procedure_date_03","notes":"Date of procedure 3. Year of introduction: 1997.","source":"OPD3","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 4","name":"procedure_date_04","notes":"Date of procedure 4. Year of introduction: 1997.","source":"OPD4","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 5","name":"procedure_date_05","notes":"Date of procedure 5. Year of introduction: 1997.","source":"OPD5","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 6","name":"procedure_date_06","notes":"Date of procedure 6. Year of introduction: 1997.","source":"OPD6","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 7","name":"procedure_date_07","notes":"Date of procedure 7. Year of introduction: 1997.","source":"OPD7","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 8","name":"procedure_date_08","notes":"Date of procedure 8. Year of introduction: 1997.","source":"OPD8","type":"date"},{"category":["medical_code","procedure"],"label":"Date of procedure 9","name":"procedure_date_09","notes":"Date of procedure 9. Year of introduction: 1997.","source":"OPD9","type":"date"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_01","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA1","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_02","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA2","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_03","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA3","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_04","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA4","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_05","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA5","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_06","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA6","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_07","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA7","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_08","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA8","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_09","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA9","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_10","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA10","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_11","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA11","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_12","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA12","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_13","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA13","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_14","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA14","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_15","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA15","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_16","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA16","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_17","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA17","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_18","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA18","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_19","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA19","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_20","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA20","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_21","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA21","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_22","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA22","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_23","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA23","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_24","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA24","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_25","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA25","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_26","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA26","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_27","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA27","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_28","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA28","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_29","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA29","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_30","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 1964","source":"DIA30","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_1","notes":"ICD-code, Year of introduction: 1964","source":"EKOD1","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_2","notes":"ICD-code, Year of introduction: 1997","source":"EKOD2","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_3","notes":"ICD-code, Year of introduction: 2009","source":"EKOD3","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_4","notes":"ICD-code, Year of introduction: 2009","source":"EKOD4","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_5","notes":"ICD-code, Year of introduction: 2009","source":"EKOD5","type":"character"},{"category":"medical_code","label":"ICD-code validation","name":"icd_validation","notes":"Best-effort validation of `diagnosis` ICD-code values using custom in-house methods.","source":"check_icd_info","type":"character"},{"category":"medical_code","label":"ICD-code version","name":"icd_version","notes":"Inferred from `diagnosis` using: 1. Year (<1997 = ICD-9), 2. Strict pattern matching, 3. Relaxed pattern matching, 4. Special case: `E872` post-1998 forced to ICD-10.","source":"HDIA_icd_v","type":"character"},{"category":"care_episode","label":"Is reporting complete","name":"report_complete","notes":"Indicates whether the care episode has been finalized by the healthcare provider. The value `final` means reporting is complete, including any corrections made within the allowed three-month window. Year of introduction: 2021.","source":"slutrapporterad","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD)","name":"diagnosis","notes":"ICD code. Includes discontinued codes, format errors, and values not found in official ICD-9/10-SE lookup assets. Year of introduction: 1964","source":"HDIA","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD)","name":"diagnosis_text","notes":"Text description of `diagnosis`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_text","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, 3-chr)","name":"diagnosis_3chr_code","notes":"Three-character ICD code, derived by truncating `diagnosis`.","source":"HDIA_3chr_code","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, 3-chr)","name":"diagnosis_3chr_text","notes":"Text description of `diagnosis_3chr_code`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_3chr_text","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, interval)","name":"diagnosis_int_code","notes":"Top-level ICD interval code, derived from `diagnosis` using in-house mapping, based on resources from the National Board of Health and Welfare","source":"HDIA_int_code","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, interval)","name":"diagnosis_int_text","notes":"Text description of `diagnosis_int_code`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_int_text","type":"character"},{"category":["medical_code","procedure"],"label":"Number of procedures recorded","name":"procedures_count","notes":"Number of reported procedures; may exceed 30. Derived from `procedures`. Replaces the variable `OP_ANT` provided by the National Board of Health and Wellfare.","source":"OP_count","type":"double"},{"category":["medical_code","procedure"],"label":"Procedure codes (KVA, space delimited list)","name":"procedures","notes":"Multiple procedure codes, space delimited, using KOP-codes (1964-1996) or KVA-code (post 1996). Includes errors, such as `-1` and `0000`. The order of procedure codes corresponds to the order of dates in `procedure_date_1`–`procedure_date_30`, assuming the codes were reported correctly. However, some inconsistencies may occur. A missing procedure date does not necessarily indicate a mismatch — dates may simply be absent. Year of introduction: 1964","source":"OP","type":"character"},{"category":"demography","label":"Sex","name":"sex","notes":"Derived from pin","source":"sex","type":"character"},{"category":"care_episode","label":"Year of discharge","name":"discharge_year","notes":"Year of introduction: 1964","source":"AR","type":"double"}]},{"id":"ps_patient-out","info":["This dataset is an extract from the National Out Patient Register (Patientregistret Öppenvård), covering the period from 2001-01-01 to 2022-03-31. It includes all individuals in the Predict cohort with a record in the register related to the requested diagnoses within this time span.","The National Board of Health and Welfare (Socialstyrelsen) provides a variable list online. Variable names correspond to the `colname_silver` value in Avan's internal codebook: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/ovrigt/register-variabelforteckning-patientregistret.xlsx>","Many records contain `BLANKED` external cause code values. This represents code values actively reducted by the National Board of Health and Welfare, because they are not included in the data application.","ICD code descriptions and hierarchical groupings included in this dataset are based on in-house translations and mappings. While we rely on official sources — from the National Board of Health and Welfare — users are encouraged to verify all annotations independently. For reference: - ICD-10-SE: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/klassifikationer-och-koder/icd-10-se.tsv>"],"subtitle":"Data extract from the National Board of Health and Welfare (Socialstyrelsen)","title":"National Out Patient Register","variables":[{"category":"demography","label":"Age at visit","name":"age_visit","notes":"Derived from `visit_date` and `birthdate`.","source":"age_visit","type":"double"},{"category":"demography","label":"Date of birth","name":"birthdate","notes":"Extracted from pin","source":"birthdate","type":"date"},{"category":"care_episode","label":"Date of visit","name":"visit_date","notes":"Year of introduction: 2001","source":"INDATUM","type":"date"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_01","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA1","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_02","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA2","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_03","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA3","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_04","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA4","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_05","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA5","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_06","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA6","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_07","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA7","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_08","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA8","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_09","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA9","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_10","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA10","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_11","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA11","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_12","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA12","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_13","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA13","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_14","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA14","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_15","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA15","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_16","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA16","type":"character"},{"category":["medical_code","diagnosis"],"label":"Diagnosis (ICD)","name":"diagnosis_17","notes":"ICD-code. The order of `diagnosis_nn` variables is not systematically meaningful across the dataset. Year of introduction: 2001","source":"DIA17","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_1","notes":"ICD-code, Year of introduction: 2001","source":"EKOD1","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_2","notes":"ICD-code, Year of introduction: 2001","source":"EKOD2","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_3","notes":"ICD-code, Year of introduction: 2009","source":"EKOD3","type":"character"},{"category":["medical_code","diagnosis"],"label":"External cause (ICD)","name":"external_cause_4","notes":"ICD-code, Year of introduction: 2009","source":"EKOD4","type":"character"},{"category":"medical_code","label":"ICD-code validation","name":"icd_validation","notes":"Best-effort validation of `diagnosis` ICD-code values using custom in-house methods.","source":"check_icd_info","type":"character"},{"category":"medical_code","label":"ICD-code version","name":"icd_version","notes":"Inferred from context; all records are dated 2001 and later.","source":"HDIA_icd_v","type":"character"},{"category":"care_episode","label":"Is reporting complete","name":"report_complete","notes":"Indicates whether the care episode has been finalized by the healthcare provider. The value `final` means reporting is complete, including any corrections made within the allowed three-month window. Year of introduction: 2021.","source":"slutrapporterad","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD)","name":"diagnosis","notes":"ICD code. Includes discontinued codes, and othervalues not found in official ICD-10-SE lookup assets. Year of introduction: 2001","source":"HDIA","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD)","name":"diagnosis_text","notes":"Text description of `diagnosis`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_text","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, 3-chr)","name":"diagnosis_3chr_code","notes":"Three-character ICD code, derived by truncating `diagnosis`.","source":"HDIA_3chr_code","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, 3-chr)","name":"diagnosis_3chr_text","notes":"Text description of `diagnosis_3chr_code`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_3chr_text","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, interval)","name":"diagnosis_int_code","notes":"Top-level ICD interval code, derived from `diagnosis` using in-house mapping, based on resources from the National Board of Health and Welfare","source":"HDIA_int_code","type":"character"},{"category":["medical_code","diagnosis"],"label":"Main diagnosis (ICD, interval)","name":"diagnosis_int_text","notes":"Text description of `diagnosis_int_code`, based on in-house translation using resources from the National Board of Health and Welfare. Untranslatable codes are represented as NA.","source":"HDIA_int_text","type":"character"},{"category":["medical_code","procedure"],"label":"Number of procedures recorded","name":"procedures_count","notes":"Number of reported procedures; may exceed 30. Derived from `procedures`. Replaces the variable `OP_ANT` provided by the National Board of Health and Wellfare.","source":"OP_count","type":"double"},{"category":["medical_code","procedure"],"label":"Procedure codes (KVA, space delimited list)","name":"procedures","notes":"Multiple procedure codes, space delimited, using KVA-code (post 1996). Year of introduction: 2001","source":"OP","type":"character"},{"category":"demography","label":"Sex","name":"sex","notes":"Derived from pin","source":"sex","type":"character"},{"category":"care_episode","label":"Year of visit","name":"visit_year","notes":"Year of introduction: 2001","source":"AR","type":"double"}]},{"id":"ps_prescribed-drug","info":["This dataset is an extract from the National Prescribed Drug Register (Läkemedelsregistret), covering the period from 2005-01-01 to 2022-03-31. The extraction was performed 2025-02-24 and includes all individuals in the Predict cohort with a record in the register.","The National Board of Health and Welfare (Socialstyrelsen) provides a variable list online. Variable names correspond to the `colname_silver` value in Avan's internal codebook: <https://www.socialstyrelsen.se/globalassets/sharepoint-dokument/ dokument-webb/statistik/register-variabelforteckning-lakemedelsregistret.xlsx>","For information about the structure and principles of the ATC classification, please refer to: <https://atcddd.fhi.no/atc/structure_and_principles>","**Posts with negative `dispensed_package_count`:** These posts represent corrections to previously recorded dispensing events. They are not standalone dispensing events, but are intended to cancel out erroneous entries. To support downstream filtering and interpretation, each negative post is annotated with a Candidate Corresponding Erroneous Post (CCEP), identified using a custom matching algorithm. The algorithm searches for a matching post from the same individual (`avanid`) with the same drug (`atc_code`) and the exact opposite quantity. The `ccep` column contains the `avan_ridx` of the matched post. The `ccep_datediff` column records the number of days between the negative post and its CCEP. This enables data users to apply their own judgment regarding the plausibility of a correction being made X days after the original event. For example, users may choose to exclude matches with long time gaps. The `ccep_filter` column marks all identified CCEPs with `drop`, regardless of time difference, to enable straightforward exclusion of putative erroneous records.","**ATC code annotations:** All records are annotated with ATC codes at the 3-character level, in addition to the full-length code. Titles corresponding to each ATC code level are added to support interpretability. ATC annotations are based on the complete ATC index from the WHO Collaborating Centre for Drug Statistics Methodology (accessed 2025-06-12): <https://atcddd.fhi.no/>. Some ATC codes in the dataset represent consumables and medical supplies, which are not part of the official WHO ATC classification. The official list of consumables is published by the Swedish Dental and Pharmaceutical Benefits Agency (TLV) and is available at: <https://www.tlv.se/download/18.4d6cf1fa167c5ffddff967/1545218568789/varugrupperingskoder.pdf> A total of 150 unique ATC codes in the dataset are not found in the official ATC reference, affecting 227,321 records. These unmatched codes fall into three categories: 1. **Codes inside the ATC code range (A-V):** There is 1 code (`D11AX00`), affecting 2 records from the same individual. It is present in the ATC reference at both the 3-character and 5-character levels. 2. **Codes that begin with Y:** Some ATC values begin with Y, representing either consumables or 'Foods for particular nutritional purposes (`Y75...`)'. There are 126 unique codes beginning with Y, affecting 224,468 posts. Of these, 89 codes are listed in TLV's list of consumables (affecting 204,451 posts), 24 codes begin with `Y75...` (affecting 11,133 posts), and 13 codes that can not be explained by either (affecting 8,884 posts). 3. **Codes that start with X or Z:** There are n = 23 unique codes that start with X or Z, affecting 2,851 posts. No explanation has been identified for these codes."],"subtitle":"Data extract from the National Board of Health and Welfare (Socialstyrelsen)","title":"National Prescribed Drug Register","variables":[{"category":"drug_dispensing","label":"Age at drug dispensing","name":"age_dispensing","notes":"Age at drug dispensing","source":"age_dispensing","type":"double"},{"category":["medical_code","drug_dispensing","atc"],"label":"Anatomical Therapeutic Chemical (ATC 3-chr)","name":"atc_3chr_code","notes":"ATC code according to the World Health Organization (WHO) (3 characters; 2nd level - therapeutic subgroup). This is a classification code used to group medications into five hierarchical levels based on their therapeutic use and chemical characteristics. ATC codes begin with a letter from A to V, indicating the primary anatomical group. This variable also includes additional codes not part of the official WHO ATC system, including (i) codes issued by the Swedish Dental and Pharmaceutical Benefits Agency (TLV) representing consumables, and (ii) codes beginning with `Y75` representing 'Foods for particular nutritional purposes...'","source":"ATC_3chr_code","type":"character"},{"category":["medical_code","drug_dispensing","atc"],"label":"Anatomical Therapeutic Chemical (ATC 7-chr)","name":"atc_code","notes":"ATC code according to the World Health Organization (WHO) (7 characters; 5th level - chemical substance). This is a classification code used to group medications into five hierarchical levels based on their therapeutic use and chemical characteristics. ATC codes begin with a letter from A to V, indicating the primary anatomical group. This variable also includes additional codes not part of the official WHO ATC system, including (i) codes issued by the Swedish Dental and Pharmaceutical Benefits Agency (TLV) representing consumables, and (ii) codes beginning with `Y75` representing 'Foods for particular nutritional purposes'","source":"ATC","type":"character"},{"category":"drug_dispensing","label":"Candidate Corresponding Erroneous Post","name":"ccep","notes":"Identifier of the Candidate Corresponding Erroneous Post (CCEP) for negative dispensing events. For each negative `dispensed_package_count` entry, this column contains the `avan_ridx` of the matched post that is presumed to have been recorded in error. If no match is found, the value is set to 'none'.","source":"ccep","type":"character"},{"category":["medical_code","drug_dispensing","atc"],"label":"Chemical substance (ATC 7-chr)","name":"atc_text","notes":"Text description of `atc_code`, based on in-house translation using the ATC index from the WHO Collaborating Centre for Drug Statistics Methodology","source":"ATC_text","type":"character"},{"category":"drug_dispensing","label":"Daily Defined Dose","name":"package_ddd","notes":"Defined Daily Doses (DDD) per package. Indicates how many Defined Daily Doses the package contains (number of treatment days). The DDD is the average Daily Dose for adults when using the medication for its main indication. DDD values are not available for licensed medications as of autumn 2013.","source":"forpddd","type":"double"},{"category":"demography","label":"Date of birth","name":"birthdate","notes":"Extracted from pin","source":"birthdate","type":"date"},{"category":"drug_dispensing","label":"Date of drug dispensing","name":"dispensing_date","notes":"Date of drug dispensing","source":"EDATUM","type":"date"},{"category":"drug_dispensing","label":"NA","name":"ccep_datediff","notes":"Number of days between the negative dispensing event and its matched CCEP. This value allows users to assess the plausibility of the correction based on time between the candidate erroneous post and the correction.","source":"ccep_datediff","type":"double"},{"category":"drug_dispensing","label":"NA","name":"ccep_filter","notes":"Flag indicating whether a post has been identified as a CCEP. All negative `dispensed_package_count` entries and matched CCEPs are marked with 'drop', regardless of time difference, to enable straightforward exclusion of possibly erroneous records. All other posts are marked with 'keep'.","source":"ccep_filter","type":"factor"},{"category":"drug_dispensing","label":"Number of packages dispensed","name":"dispensed_package_count","notes":"Number of packages dispensed to the patient. For dose-dispensed medications, this value may be a decimal. Negative values occur when a previously recorded dispensing event is corrected — in such cases, the erroneous entry is offset by a new row with a negative value. To support interpretation and filtering, all negative dispensed_package_count entries are annotated with a Candidate Corresponding Erroneous Post (CCEP) identified using a custom matching algorithm.","source":"ANTAL","type":"double"},{"category":"demography","label":"Sex","name":"sex","notes":"Derived from pin","source":"sex","type":"character"},{"category":["medical_code","drug_dispensing","atc"],"label":"Therapeutic subgroup (ATC 3-chr)","name":"atc_3chr_text","notes":"Text description of `atc_3chr_code`, based on in-house translation using the ATC index from the WHO Collaborating Centre for Drug Statistics Methodology","source":"ATC_3chr_text","type":"character"},{"category":"drug_dispensing","label":"Year of drug dispensing","name":"dispensing_year","notes":"Year of drug dispensing","source":"ar","type":"double"}]}]</script>

  <script>
  (function(){
    const state = {
      datasets: [],
      selected: new Map(), // key: compound id (datasetId::varName), value: record
    };

    function $(sel, root=document){ return root.querySelector(sel); }
    function $all(sel, root=document){ return Array.from(root.querySelectorAll(sel)); }

    function parseData(){
      const raw = document.getElementById('dataset-json').textContent.trim();
      try {
        const data = JSON.parse(raw);
        if (!Array.isArray(data)) return [];
        return data;
      } catch(e){
        console.error('Failed to parse dataset JSON', e);
        return [];
      }
    }

    function render(){
      const app = document.getElementById('app');
      app.innerHTML = '';

      state.datasets.forEach(ds => {
        const card = document.createElement('section');
        card.className = 'dataset-card';
        card.dataset.datasetId = ds.id;

        card.innerHTML = `
          <div class="dataset-header">
            <h2 class="dataset-title">${escapeHTML(ds.title || ds.id)}</h2>
            ${ds.subtitle ? `<div class="dataset-subtitle">${escapeHTML(ds.subtitle)}</div>` : ''}
            ${ds.info ? `<div class="dataset-info">${escapeHTML(ds.info)}</div>` : ''}
          </div>
          <div class="controls">
            <input type="search" placeholder="Search in this dataset… (label, variable name, notes)" aria-label="Search variables" />
            <div class="info">${ds.variables.length} variables</div>
          </div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th style="width: 2rem"><input type="checkbox" data-action="toggle-all"></th>
                  <th>Label</th>
                  <th class="hide-sm">Variable name</th>
                  <th class="hide-sm">Source variable name</th>
                  <th class="hide-sm">Type</th>
                  <th class="hide-sm">Category</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        `;

        const tbody = card.querySelector('tbody');
        ds.variables.forEach(v => tbody.appendChild(renderRow(ds, v)));

        // Hook up search
        const search = card.querySelector('input[type="search"]');
        search.addEventListener('input', () => applyFilter(card, ds, search.value));

        // Hook up toggle-all
        const toggleAll = card.querySelector('[data-action="toggle-all"]');
        toggleAll.addEventListener('change', (e) => {
          const rows = $all('tbody tr', card).filter(r => r.style.display !== 'none');
          rows.forEach(r => {
            const cb = r.querySelector('input[type="checkbox"]');
            cb.checked = e.target.checked;
            cb.dispatchEvent(new Event('change'));
          });
        });

        app.appendChild(card);
      });

      updateCartUI();
    }

    function renderRow(ds, v){
      const tr = document.createElement('tr');
      const key = ds.id + '::' + v.name;
      tr.dataset.key = key;

      tr.innerHTML = `
        <td><input type="checkbox" aria-label="Select ${escapeHTML(v.label || v.name)}"></td>
        <td>
          <div class="var-label">${escapeHTML(v.label || v.name)}</div>
          ${v.notes ? `<details><summary>Notes</summary><div class="var-notes">${escapeHTML(v.notes)}</div></details>` : ''}
        </td>
        <td class="mono hide-sm">${escapeHTML(v.name)}</td>
        <td class="mono hide-sm">${escapeHTML(v.source || '')}</td>
        <td class="hide-sm">${escapeHTML(v.type || '')}</td>
        <td class="hide-sm">${escapeHTML(v.category || '')}</td>
      `;

      const cb = tr.querySelector('input[type="checkbox"]');
      cb.checked = state.selected.has(key);
      cb.addEventListener('change', () => {
        if (cb.checked){ state.selected.set(key, toCSVRecord(ds, v)); }
        else { state.selected.delete(key); }
        updateCartUI();
      });
      return tr;
    }

    function applyFilter(card, ds, term){
      const q = (term || '').toLowerCase();
      const rows = $all('tbody tr', card);
      rows.forEach(r => {
        const key = r.dataset.key;
        const v = ds._byKey[key];
        const blob = (v._search || '').toLowerCase();
        r.style.display = blob.includes(q) ? '' : 'none';
      });
      // When filtering, uncheck the header checkbox
      const toggleAll = card.querySelector('[data-action="toggle-all"]');
      toggleAll.checked = false;
    }

    function toCSVRecord(ds, v){
      return {
        dataset_id: ds.id,
        dataset_title: ds.title || ds.id,
        variable_name: v.name,
        label: v.label || '',
        source_variable_name: v.source || '',
        type: v.type || '',
        category: v.category || '',
        notes: v.notes || ''
      };
    }

    function updateCartUI(){
      const countEl = document.getElementById('cart-count');
      const dlBtn = document.getElementById('download-csv');
      const clearBtn = document.getElementById('clear-selection');
      const n = state.selected.size;
      countEl.textContent = String(n);
      dlBtn.disabled = n === 0;
      clearBtn.disabled = n === 0;
    }

    function downloadCSV(){
      const rows = Array.from(state.selected.values());
      if (!rows.length) return;
      const headers = [
        'dataset_id','dataset_title','variable_name','label','source_variable_name','type','category','notes'
      ];
      const csv = [headers.join(',')].concat(
        rows.map(r => headers.map(h => csvEscape(r[h] ?? '')).join(','))
      ).join('\n');
      const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'predict_variables.csv';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    }

    function clearSelection(){
      state.selected.clear();
      // Uncheck all checkboxes
      document.querySelectorAll('tbody input[type="checkbox"]').forEach(cb => cb.checked = false);
      updateCartUI();
    }

    function csvEscape(value){
      const s = String(value).replace(/\r?\n/g, ' ');
      if (s.includes(',') || s.includes('"')){
        return '"' + s.replace(/"/g, '""') + '"';
      }
      return s;
    }

    function escapeHTML(s){
      return String(s)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#39;");
    }

    // Wire global buttons
    window.addEventListener('DOMContentLoaded', () => {
      state.datasets = parseData();
      // Precompute search blobs and lookup
      state.datasets.forEach(ds => {
        ds._byKey = {};
        ds.variables.forEach(v => {
          v._search = [v.label, v.name, v.notes].filter(Boolean).join(' ');
          const key = ds.id + '::' + v.name;
          ds._byKey[key] = v;
        });
      });

      render();
      document.getElementById('download-csv').addEventListener('click', downloadCSV);
      document.getElementById('clear-selection').addEventListener('click', clearSelection);
    });
  })();
  </script>

  <footer>
    <p>Generated from YAML sources. Input files and hash:</p>
    <pre style="white-space: pre-wrap; word-break: break-word;">ps_cancer_register_codebook.yaml  47fa3369933fcb7081c674d2870e4380afa445da44303702a7e64432ab7fc8fc
ps_cancer_register_meta.yaml  989e0462d76845a97b557f13e22c008e76a43efc77318ce46a7d00cb191aab8f
ps_cause-of-death_register_codebook.yaml  fda60961750a69f1c6188b7eda0f761cb8dfbfdd007069b0d1d269cd63c5f3e9
ps_cause-of-death_register_meta.yaml  0b26e6434814a0fadf60fd0e2c290ac23355345735abcfc594ef52174d5b7c08
ps_patient-in_register_codebook.yaml  b1a5ff122752e13fcf1224a3b74efc8ebd4d356604cb4eca68124b99d0aeab2d
ps_patient-in_register_meta.yaml  2f495473a2707e6e00ac55ebae68e59e79b1494e034703d8723e3a2a31dbcd37
ps_patient-out_register_codebook.yaml  0baea588209ff9d84435adc4e7f9d43d56f8f90aa553eee404a576b125a14335
ps_patient-out_register_meta.yaml  67f5aa434a8ccfe9a32e5cb3226fd9201eef8de82870be9aea10e1d27f9d51a4
ps_prescribed-drug_register_codebook.yaml  d18a1fbcb0f9396930a8a700765cb9c978b00138173f9d4e14b8d6c25efedb63
ps_prescribed-drug_register_meta.yaml  f83373815f4e1948478757b6e469013659152262c9942db02f75d821d20b4d99

Combined SHA-256: 22aa6b26fd6d42120824ef2817d669d472fc46074e22730f1bcfda47cbb15feb</pre>
  </footer>
</body>
</html>